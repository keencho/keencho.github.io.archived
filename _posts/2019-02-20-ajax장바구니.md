---
layout: post
title: Ajax를 이용해 장바구니 추가
categories: [Front-End]
tags: [jQuery, css, Codeigniter, Ajax]
description: Ajax를 이용해 Codeigniter 장바구니 추가
comments: true
---

아래 기술할 소스는 '장바구니에 추가'버튼을 클릭하면 Ajax를 이용해 Codeigniter의 Cart기능을 사용해 장바구니에 추가하는 소스이다.  
<br>
### 장바구니에 추가 버튼 클릭시 호출될 Ajax 함수  
~~~javascript
$(function(){
    $("a.cart_add").click( function() { // 클래스명이 cart_add인 a 태그를 클릭시
        var id = $("#id").val(); // 관련 값들은 미리 hidden이나 text타입으로 넣어둠
        var qty = $("#qty").val();
        var name = $("#name").val();
        var model = $("#model").val();
        var brand = $("#brand").val();
        var img = $("#img").val();
        var price = $("#price").val();
        $.ajax({					
            url: "<?=site_url('CI/Cart/add')?>",
            type: "POST",
            data:{
                "id":id,
                "qty":qty,
                "name":name,
                "model":model,
                "brand":brand,
                "img":img,
                "price":price
            },
            dataType:"html",
            success : function() {
                $("span.overlay_popup").css({
                "top":(($(window).height()-$("span.overlay_popup").outerHeight())/2+$(window).scrollTop())+"px", 
                "left": (($(window).width()-$("span.overlay_popup").outerWidth())/2+$(window).scrollLeft())+"px"
                //위 두 줄의 소스는, 현재 화면 정가운데에 출력하도록하는 소스이다
            });
            $( "span.btn-popup01" ).addClass( "popup-open" ).fadeIn(2000);
            },		
        });
    });
});
~~~  
Codeigtnier의 Cart 라이브러리는 id, qty, name, price 4가지의 요소가 필수이므로 꼭 추가해줘야한다.  
추가가 성공하면, 아래 이미지 처럼 화면 가운데에 장바구니 화면으로 이동할지 안갈지 선택하는 레이어 팝업창을 띄운다.
![cartadd](https://user-images.githubusercontent.com/36055500/54453212-33235500-479a-11e9-98ea-2ad7916f849d.JPG)
<br><br>
### 버튼을 누르기전엔 나오지 않는 레이어 팝업 소스  
~~~html
<div>
    <span class="overlay_popup btn-popup01">
        <button>
            <a onclick="$(this).popupClose();">
                <img src="<? echo base_url(); ?>CI/userimg/pop_msg_close.gif" alt="아니오">&nbsp
            </a>
        </button>
        <h3><font color="red"><br>장바구니</font>에 상품이 담겼습니다.</h3>
        <h6>장바구니로 이동하시겠습니까?</h6><br>
        <button>
            <img src="<? echo base_url(); ?>CI/userimg/pop_msg_yes.gif" alt="예" onclick="location.href='<?=site_url('CI/Cart');?>'">
        </button>
        <button>
            <img src="<? echo base_url(); ?>CI/userimg/pop_msg_no.gif" alt="아니오" onclick="$(this).popupClose();">
        </button>
    </span>
</div>
~~~  
<br>
### 팝업 레이어 css
~~~css
.popup-layout {
    padding: 10px;
    font-size: 1.5rem;
    background-color: #d5d5d5;
    border: 3px solid #ddd;
    margin: 15px;
    box-shadow: 0px 0px 15px #888888;
    cursor: pointer;
}

.popup-layout:hover {
    box-shadow: 0px 0px 10px #888888;
}

body:after {
    content: "";
    display: none;
    position: absolute; /* could also be absolute */ 
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    z-index: 1201;
    background: rgba(0,0,0,0.6);
}

.overlay_popup {
    display: none;
    padding: 10px;
    width: 300px;
    height: 200px;
    position: absolute;
    top: 0px;
    left: 0px;
    background-color: #fff;
    border-radius: 5px;
    text-align: center;
    z-index: 1201; /* 1px higher than the overlay layer */
    border: 2px solid;
    border-color: #F47520;
    border-radius: 5px;
}

body.popup-open:after, .popup-open {
    display: block;
}
~~~

