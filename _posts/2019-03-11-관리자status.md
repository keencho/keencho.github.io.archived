---
layout: post
title: 쇼핑몰 주문상태 즉시변경
categories: [Front-End]
tags: [jQuery, Ajax, Codeigniter]
description: Ajax를 활용해 관리자 페이지에서 주문상태 즉시 변경하기
comments: true
---

![주문상태_변경](https://user-images.githubusercontent.com/36055500/54458856-56ed9780-47a8-11e9-870e-d8348fb93f57.jpg)  
<br>
구현하고자 하는 기능의 디자인 형태는 이러하며, 각각의 select box를 클릭하면 입금대기, 결제완료 등의 option이 들어가있다.  
select box에서 원하는 option을 선택하면 즉시 바뀔수 있게 Ajax 기능을 활용하였다.  
<br>
### option값을 화면에 출력하는 소스
~~~php
<select class="custom-select" id="status_select" name="status_select[]" onchange="location = this.value;">
<?
	$uri_array=$this->uri->uri_to_assoc(3);
		$sortno=array_key_exists("no",$uri_array) ? $uri_array["no"] : "" ;

		for($i=0;$i<$n_sort;$i++){ 
		if($row->status==$i){
			echo("<option value='$i' selected>$a_sort[$i]</option>");
		}
		else{
			echo("<option value='javascript:status_ajax(\"$row->orderno\",\"$i\");'>$a_sort[$i]</option>");
		}
	}
?>
</select>
~~~  
미리 $n_sort와 $a_sort를 정의해두고, for문을 돌려 option을 출력하도록 코딩하였다.  
select box에 onchange 옵션을 두고 현재 선택한 option value에 javascript를 호출할수 있는 코드를 넣어두어서 처리하였다.  
<br>
### 주문상태 변환 Ajax
~~~javascript
function status_ajax(no,status) {
	$(document).ready(function(){
		$.ajax({					
			url: "<?=site_url('CI/Admin_Order/statusupdate/no/')?>" + no,
			type: "POST"
			data: {
				"no":no,
				"status":status
			},
			dataType:"html",
			success : function() {
				alert("변경완료");
			},
			error : function() {
				alert("실패");
			}
		});
	});
}
~~~  
작업이 성공하면 "변경완료"라는 알림창을, 실패하면 "실패"라는 알림창을 띄우도록 처리하였다.
